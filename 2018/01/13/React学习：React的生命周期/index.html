<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="react," />










<meta name="description" content="å…³äºåˆ›å»ºç»„ä»¶çš„ä¸€æ®µå†å²ã€æ—©æœŸã€‘åˆ›å»ºä¸€ä¸ªç»„ä»¶æœ‰ä¸‰ç§æ–¹æ³•ï¼šé€šè¿‡ React.createClassã€ES6 classã€Functionã€‚ã€ç°åœ¨ã€‘éšç€React v16.0çš„å‘å¸ƒï¼ŒReactä¸­React.createClassè¿™ä¸ªæ–¹æ³•çš„å®ç°è¢«ç§»é™¤ï¼Œfacebookæä¾›ä¸€ä¸ªå•ç‹¬çš„åŒ…ï¼šcreate-react-classï¼Œç”¨äºå®ç°React.createClassçš„åŠŸèƒ½ã€‚ React.createClas">
<meta name="keywords" content="react">
<meta property="og:type" content="article">
<meta property="og:title" content="Reactå­¦ä¹ ï¼šReactçš„ç”Ÿå‘½å‘¨æœŸ">
<meta property="og:url" content="http://xiaoxiaojing.github.io/2018/01/13/Reactå­¦ä¹ ï¼šReactçš„ç”Ÿå‘½å‘¨æœŸ/index.html">
<meta property="og:site_name" content="XIAOXIAOJING">
<meta property="og:description" content="å…³äºåˆ›å»ºç»„ä»¶çš„ä¸€æ®µå†å²ã€æ—©æœŸã€‘åˆ›å»ºä¸€ä¸ªç»„ä»¶æœ‰ä¸‰ç§æ–¹æ³•ï¼šé€šè¿‡ React.createClassã€ES6 classã€Functionã€‚ã€ç°åœ¨ã€‘éšç€React v16.0çš„å‘å¸ƒï¼ŒReactä¸­React.createClassè¿™ä¸ªæ–¹æ³•çš„å®ç°è¢«ç§»é™¤ï¼Œfacebookæä¾›ä¸€ä¸ªå•ç‹¬çš„åŒ…ï¼šcreate-react-classï¼Œç”¨äºå®ç°React.createClassçš„åŠŸèƒ½ã€‚ React.createClas">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://xiaoxiaojing.github.io/2018/01/13/Reactå­¦ä¹ ï¼šReactçš„ç”Ÿå‘½å‘¨æœŸ/react_lifecycle_1.png">
<meta property="og:updated_time" content="2018-06-23T09:07:43.735Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Reactå­¦ä¹ ï¼šReactçš„ç”Ÿå‘½å‘¨æœŸ">
<meta name="twitter:description" content="å…³äºåˆ›å»ºç»„ä»¶çš„ä¸€æ®µå†å²ã€æ—©æœŸã€‘åˆ›å»ºä¸€ä¸ªç»„ä»¶æœ‰ä¸‰ç§æ–¹æ³•ï¼šé€šè¿‡ React.createClassã€ES6 classã€Functionã€‚ã€ç°åœ¨ã€‘éšç€React v16.0çš„å‘å¸ƒï¼ŒReactä¸­React.createClassè¿™ä¸ªæ–¹æ³•çš„å®ç°è¢«ç§»é™¤ï¼Œfacebookæä¾›ä¸€ä¸ªå•ç‹¬çš„åŒ…ï¼šcreate-react-classï¼Œç”¨äºå®ç°React.createClassçš„åŠŸèƒ½ã€‚ React.createClas">
<meta name="twitter:image" content="http://xiaoxiaojing.github.io/2018/01/13/Reactå­¦ä¹ ï¼šReactçš„ç”Ÿå‘½å‘¨æœŸ/react_lifecycle_1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":13,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://xiaoxiaojing.github.io/2018/01/13/Reactå­¦ä¹ ï¼šReactçš„ç”Ÿå‘½å‘¨æœŸ/"/>





  <title>Reactå­¦ä¹ ï¼šReactçš„ç”Ÿå‘½å‘¨æœŸ | XIAOXIAOJING</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">XIAOXIAOJING</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">JUST DO IT</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://xiaoxiaojing.github.io/2018/01/13/Reactå­¦ä¹ ï¼šReactçš„ç”Ÿå‘½å‘¨æœŸ/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="TJ">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/my.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XIAOXIAOJING">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Reactå­¦ä¹ ï¼šReactçš„ç”Ÿå‘½å‘¨æœŸ</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-13T14:24:44+08:00">
                2018-01-13
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2018-06-23T17:07:43+08:00">
                2018-06-23
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Reactç³»åˆ—/" itemprop="url" rel="index">
                    <span itemprop="name">Reactç³»åˆ—</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="å…³äºåˆ›å»ºç»„ä»¶çš„ä¸€æ®µå†å²"><a href="#å…³äºåˆ›å»ºç»„ä»¶çš„ä¸€æ®µå†å²" class="headerlink" title="å…³äºåˆ›å»ºç»„ä»¶çš„ä¸€æ®µå†å²"></a>å…³äºåˆ›å»ºç»„ä»¶çš„ä¸€æ®µå†å²</h2><p>ã€æ—©æœŸã€‘åˆ›å»ºä¸€ä¸ªç»„ä»¶æœ‰ä¸‰ç§æ–¹æ³•ï¼šé€šè¿‡ <strong><code>React.createClass</code>ã€<code>ES6 class</code>ã€<code>Function</code></strong>ã€‚<br>ã€ç°åœ¨ã€‘éšç€<code>React v16.0</code>çš„å‘å¸ƒï¼Œ<code>React</code>ä¸­<code>React.createClass</code>è¿™ä¸ªæ–¹æ³•çš„å®ç°è¢«ç§»é™¤ï¼Œfacebookæä¾›ä¸€ä¸ªå•ç‹¬çš„åŒ…ï¼š<a href="https://yarnpkg.com/en/package/create-react-class" target="_blank" rel="external"><code>create-react-class</code></a>ï¼Œç”¨äºå®ç°<code>React.createClass</code>çš„åŠŸèƒ½ã€‚</p>
<h3 id="React-createClass"><a href="#React-createClass" class="headerlink" title="React.createClass"></a><code>React.createClass</code></h3><p>ã€ä¸¤ä¸ªæ–¹æ³•ã€‘ä½¿ç”¨<code>React.createClass</code>æ–¹æ³•åˆ›å»ºç»„ä»¶éœ€è¦è®¾ç½®ä¸¤ä¸ªæ–¹æ³•ï¼š<code>getInitialState</code>ï¼ˆåˆå§‹åŒ–stateï¼‰ã€<code>getDefaultProps</code>ï¼ˆæä¾›é»˜è®¤çš„propsï¼‰<br>ã€éœ€è¦æ³¨æ„ã€‘<code>getDefaultProps</code>åªä¼šåœ¨ç»„ä»¶åˆ›å»ºçš„æ—¶å€™è°ƒç”¨ä¸€æ¬¡ï¼Œ<code>getInitialState</code>ä¼šåœ¨ç»„ä»¶æ¯æ¬¡è£…è½½çš„æ—¶å€™è°ƒç”¨<br>ã€ä¸€ä¸ªğŸŒ°ã€‘åœ¨è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬ç»™çˆ¶å­ç»„ä»¶åˆ†åˆ«å®šä¹‰äº†<code>getDefaultProps</code>å’Œ<code>getInitialState</code>ï¼Œç”±äºçˆ¶ç»„ä»¶ä¸­åŠ è½½äº†ä¸¤ä¸ªå­ç»„ä»¶ï¼Œæ‰€ä»¥å­ç»„ä»¶çš„<code>getInitialState</code>è°ƒç”¨äº†ä¸¤æ¬¡ï¼Œä½†æ˜¯<code>getDefaultProps</code>åªè°ƒç”¨äº†ä¸€æ¬¡ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">const React = require(&apos;react&apos;)</div><div class="line">const createReactClass = require(&apos;create-react-class&apos;)</div><div class="line"></div><div class="line">const ChildComponent = createReactClass(&#123;</div><div class="line">  getDefaultProps () &#123;</div><div class="line">    console.log(&apos;create child props&apos;)</div><div class="line">    return &#123;&#125;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  getInitialState () &#123;</div><div class="line">    console.log(&apos;init child state&apos;)</div><div class="line">    return &#123;&#125;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  render () &#123;</div><div class="line">    return (</div><div class="line">      &lt;div&gt;</div><div class="line">        this is a child component which create by createClass</div><div class="line">      &lt;/div&gt;</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line">const ParentComponent = createReactClass(&#123;</div><div class="line">  getDefaultProps () &#123;</div><div class="line">    console.log(&apos;create parent props&apos;)</div><div class="line">    return &#123;&#125;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  getInitialState () &#123;</div><div class="line">    console.log(&apos;init parent state&apos;)</div><div class="line">    return &#123;&#125;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  render () &#123;</div><div class="line">    return (</div><div class="line">      &lt;div&gt;</div><div class="line">        this is a parent component which create by createClass</div><div class="line">        &lt;ChildComponent /&gt;</div><div class="line">        &lt;ChildComponent /&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line">export default ParentComponent</div></pre></td></tr></table></figure></p>
<p>ã€ç¨‹åºè¿è¡Œç»“æœã€‘å¦‚ä¸‹æ‰€ç¤ºï¼Œ<code>getDefaultProps</code>åªä¼šåœ¨ç»„ä»¶åˆ›å»ºçš„æ—¶å€™è°ƒç”¨ä¸€æ¬¡ï¼Œ<code>getInitialState</code>ä¼šåœ¨ç»„ä»¶æ¯æ¬¡è£…è½½çš„æ—¶å€™è°ƒç”¨ä¸€æ¬¡ã€‚çˆ¶ç»„ä»¶ä¸­åŒ…å«äº†ä¸¤ä¸ªå­ç»„ä»¶ï¼Œæ‰€ä»¥<code>init child state</code>æ‰“å°äº†ä¸¤æ¬¡ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">create child props</div><div class="line">create parent props</div><div class="line">init parent state</div><div class="line">init child state</div><div class="line">init child state</div></pre></td></tr></table></figure></p>
<p>åœ¨ä¸Šé¢çš„ğŸŒ°ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†<code>getDefaultProps</code>å’Œ<code>getInitialState</code>ï¼Œå®ƒä»¬å¯¹äºç»„ä»¶æ¥è¯´éƒ½æ˜¯ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚ä¸‹é¢å…·ä½“è¯´æ˜ä¸€ä¸‹ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚</p>
<h2 id="ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ"></a>ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ</h2><p>ç”Ÿå‘½å‘¨æœŸï¼ˆlife-cycleï¼‰æ˜¯ç›¸å¯¹äºç»„ä»¶ï¼ˆcomponentï¼‰æ¥è¯´çš„ï¼Œæ¯ä¸ªç»„ä»¶éƒ½ä¼šç»å†ä¸€ä¸ªä»è£…è½½ï¼ˆMountï¼‰åˆ°å¸è½½ï¼ˆUnmountï¼‰çš„è¿‡ç¨‹ã€‚<br>ä»¥ä¸‹è®¨è®ºçš„ç”Ÿå‘½å‘¨æœŸéƒ½æ˜¯é’ˆå¯¹äºé€šè¿‡<code>ES6 class</code>åˆ›å»ºçš„ç»„ä»¶æ¥åˆ†æçš„ï¼Œè¿™äº›é€šè¿‡<code>ES6 class</code>åˆ›å»ºçš„ç»„ä»¶ä¼šè¢«æ·»åŠ tagï¼ˆtagå€¼ä¸ºï¼š<code>ClassComponent</code>ï¼‰ã€‚è¿™ç±»ç»„ä»¶æœ‰ä»¥ä¸‹ç”Ÿå‘½å‘¨æœŸå‡½æ•°<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">constructor(props)</div><div class="line">componentWillMount()</div><div class="line">componentDidMount()</div><div class="line">componentWillReceiveProps(nextProps, nextState, newContext)</div><div class="line">shouldComponentUpdate(prevProps, prevState)</div><div class="line">componentWillUpdate(newProps, newState, newContext)</div><div class="line">componentDidUpdate(prevProps, prevState)</div><div class="line">componentWillUnmount()</div><div class="line">render()</div><div class="line">componentDidCatch(error, info)</div></pre></td></tr></table></figure></p>
<p>ä»–ä»¬çš„æ‰§è¡Œæƒ…å†µå¦‚ä¸‹å›¾æ‰€ç¤º</p>
<div style="max-width:600px;"><br><img src="/2018/01/13/Reactå­¦ä¹ ï¼šReactçš„ç”Ÿå‘½å‘¨æœŸ/react_lifecycle_1.png" alt="react_lifecycle_1.png" title=""><br></div>

<h2 id="Unmountingé˜¶æ®µ"><a href="#Unmountingé˜¶æ®µ" class="headerlink" title="Unmountingé˜¶æ®µ"></a>Unmountingé˜¶æ®µ</h2><p>åœ¨ç»„ä»¶å¸è½½é˜¶æ®µï¼Œè¿™ä¸ªé˜¶æ®µä¼šè°ƒç”¨<code>componentWillUnmount</code>ã€‚<br>ä¼šå¯¼è‡´ç»„ä»¶å¸è½½çš„æƒ…å†µï¼šç»„ä»¶è¢«åˆ é™¤ã€‚<br>åœ¨<code>componentWillUnmount</code>ä¸­å¯ä»¥åšï¼šæ¸…é™¤å®šæ—¶å™¨ã€å–æ¶ˆç½‘ç»œè¯·æ±‚ã€æ¸…é™¤åœ¨componentDidMountä¸­å®šä¹‰çš„ç›‘å¬å™¨</p>
<h3 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><p>å½“ç»„ä»¶å¸è½½çš„æ—¶å€™ï¼Œå¯¹äº<code>ES6 class</code>åˆ›å»ºçš„ç»„ä»¶ï¼Œä¼šæ‰§è¡Œtagä¸º<code>ClassComponent</code>çš„å¯¹åº”ç³»åˆ—ç¨‹åºï¼Œæœ€ç»ˆä¼šè°ƒç”¨<code>callComponentWillUnmountWithTimer</code>è¿™ä¸ªæ–¹æ³•ï¼Œè¿›è€Œè°ƒç”¨<code>componentWillUnmount</code>æ–¹æ³•ã€‚ï¼ˆ<a href="https://github.com/facebook/react/blob/v16.2.0/packages/react-reconciler/src/ReactFiberCommitWork.js" target="_blank" rel="external">ReactFiberCommitWork.js</a>ï¼‰<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">var callComponentWillUnmountWithTimer = function(current, instance) &#123;</div><div class="line">  startPhaseTimer(current, &apos;componentWillUnmount&apos;);</div><div class="line">  instance.props = current.memoizedProps;</div><div class="line">  instance.state = current.memoizedState;</div><div class="line">  instance.componentWillUnmount(); // è°ƒç”¨componentWillUnmount</div><div class="line">  stopPhaseTimer();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="å®ä¾‹è¯´æ˜"><a href="#å®ä¾‹è¯´æ˜" class="headerlink" title="å®ä¾‹è¯´æ˜"></a>å®ä¾‹è¯´æ˜</h3><p>å¦‚ä¸‹æ‰€ç¤ºï¼Œç‚¹å‡»buttonåå­ç»„ä»¶ä¼šè¢«åˆ é™¤ï¼Œåœ¨ç§»é™¤ä¹‹å‰ä¼šè°ƒç”¨<code>componentWillUnmount</code>ï¼ˆé™¤æ­¤ä¹‹å¤–ï¼Œä¸ä¼šå†è°ƒç”¨å…¶ä»–ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼‰ï¼Œè¾“å‡º<code>component will unmount</code>ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">import React, &#123;Component&#125; from &apos;react&apos;</div><div class="line"></div><div class="line">export default class MountTest extends Component &#123;</div><div class="line">  constructor (props, context) &#123;</div><div class="line">    super(props)</div><div class="line">    this.state = &#123;show: true&#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  componentWillUnmount () &#123;</div><div class="line">    console.log(&apos;component did unmount&apos;)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  handler = () =&gt; &#123;</div><div class="line">    this.setState(&#123;show: false&#125;)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render () &#123;</div><div class="line">    return (</div><div class="line">      &lt;div&gt;</div><div class="line">        &#123;this.state.show &amp;&amp; &lt;ChildComponent /&gt;&#125;</div><div class="line">        test the unmount process, this is a parent</div><div class="line">        &lt;button onClick=&#123;this.handler&#125;&gt;remove&lt;/button&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">class ChildComponent extends Component &#123;</div><div class="line">  constructor (props, context) &#123;</div><div class="line">    super(props)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  componentWillUnmount () &#123;</div><div class="line">    console.log(&apos;component will unmount&apos;)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render () &#123;</div><div class="line">    return (</div><div class="line">      &lt;div&gt;</div><div class="line">        the child component will be remove</div><div class="line">      &lt;/div&gt;</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Mountingé˜¶æ®µ"><a href="#Mountingé˜¶æ®µ" class="headerlink" title="Mountingé˜¶æ®µ"></a>Mountingé˜¶æ®µ</h2><p>è¿™ä¸ªé˜¶æ®µä¼šä¾æ¬¡è°ƒç”¨<code>constructor</code>ã€<code>componentWillMount</code>ã€<code>render</code>ã€<code>componentDidMount</code>ã€‚<br>å…¶ä¸­<code>constructor</code>ã€<code>componentWillMount</code>ã€<code>componentDidMount</code>æœ‰ä¸”åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ã€‚</p>
<p>Reactä¼šå…ˆåˆ¤æ–­ç»„ä»¶æœ‰æ²¡æœ‰è£…è½½ï¼Œå¦‚æœæ²¡æœ‰å°±æ‰§è¡Œè£…è½½çš„æµç¨‹ï¼Œå¦‚æœæœ‰è£…è½½å°±æ‰§è¡Œæ›´æ–°çš„æµç¨‹ã€‚ï¼ˆ<a href="https://github.com/facebook/react/blob/v16.2.0/packages/react-reconciler/src/ReactFiberBeginWork.js" target="_blank" rel="external">ReactFiberBeginWork.js</a>ï¼‰<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">function updateClassComponent (current, workInProgress, renderExpirationTime) &#123;</div><div class="line">  let shouldUpdate</div><div class="line">  if (current == null) &#123; // å¦‚æœå½“å‰èŠ‚ç‚¹ä¸å­˜åœ¨ï¼Œå°±è¿›è¡Œåˆå§‹åŒ–æ“ä½œ</div><div class="line">    if (!workInProgress.stateNode) &#123;</div><div class="line">        // In the initial pass we might need to construct the instance.</div><div class="line">        constructClassInstance(workInProgress, workInProgress.pendingProps);</div><div class="line">        mountClassInstance(workInProgress, renderExpirationTime);</div><div class="line">        shouldUpdate = true;</div><div class="line">      &#125;</div><div class="line">  &#125; else &#123;</div><div class="line">    shouldUpdate = updateClassInstance(current, workInProgress, renderExpirationTime);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="constructor-props-context"><a href="#constructor-props-context" class="headerlink" title="constructor(props, context)"></a>constructor(props, context)</h3><p>åœ¨<code>constructor</code>åˆå§‹åŒ–<code>state</code>ï¼Œæ‰§è¡Œ<code>this.state={...}</code>ï¼ˆç›¸å½“äºè°ƒç”¨<code>getInitialState</code>æ–¹æ³•ï¼‰<br>åœ¨<code>constructor</code>ä¸­å¿…é¡»è°ƒç”¨<code>super(props)</code>ï¼Œè¿™æ ·æ‰èƒ½ä½¿å¾—<code>this.props</code>æœ‰å€¼</p>
<p><code>workInProgress.type</code>å…¶æŒ‡å‘å½“å‰æ­£åœ¨è¢«è£…è½½çš„ç»„ä»¶ï¼Œæ‰§è¡Œ<code>new ctor(props, context)</code>æ—¶ï¼Œä¼šè°ƒç”¨ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°<code>constructor</code>ã€‚ï¼ˆ<a href="https://github.com/facebook/react/blob/v16.2.0/packages/react-reconciler/src/ReactFiberClassComponent.js" target="_blank" rel="external">ReactFiberClassComponent.js</a>ï¼‰<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">function constructClassInstance(workInProgress: Fiber, props: any): any &#123;</div><div class="line">  const ctor = workInProgress.type; // è·å–ç»„ä»¶</div><div class="line">  const unmaskedContext = getUnmaskedContext(workInProgress);</div><div class="line">  const needsContext = isContextConsumer(workInProgress);</div><div class="line">  const context = needsContext ? getMaskedContext(workInProgress, unmaskedContext): emptyObject;</div><div class="line">  const instance = new ctor(props, context); // åˆ›å»ºç»„ä»¶å®ä¾‹</div><div class="line">  // ...</div><div class="line">  return instance;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="componentWillMount"><a href="#componentWillMount" class="headerlink" title="componentWillMount()"></a>componentWillMount()</h3><p>åœ¨è¿™ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­å¯ä»¥æ‰§è¡Œ<code>this.setState</code>æ›´æ–°stateï¼Œä½¿å¾—åç»­è®¿é—®çš„stateä¸ºæ›´æ–°åçš„stateã€‚å¹¶ä¸”è°ƒç”¨<code>this.setState</code>ä¸ä¼šè§¦å‘äºŒæ¬¡æ›´æ–°ã€‚</p>
<p>åœ¨<code>mountClassInstance</code>æ–¹æ³•ä¸­æœ‰ä¸€å¥æ³¨é‡Šï¼š<code>If we had additional state updates during this life-cycle, let&#39;s process them now</code>ã€‚å½“stateæœ‰å˜åŒ–æ—¶ï¼Œä¼šè°ƒç”¨<code>updater.enqueueReplaceState</code>å°†æ›´æ–°åŠ å…¥åˆ°æ›´æ–°é˜Ÿåˆ—ä¸­ï¼Œå¦‚æœ<code>updateQueue</code>æœ‰å€¼ï¼Œå°±ä¼šè°ƒç”¨<code>processUpdateQueue</code>æ–¹æ³•ï¼Œæ‰§è¡Œæ›´æ–°æ“ä½œã€‚ ï¼ˆ<a href="https://github.com/facebook/react/blob/v16.2.0/packages/react-reconciler/src/ReactFiberClassComponent.js" target="_blank" rel="external">ReactFiberClassComponent.js</a>ï¼‰<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">function mountClassInstance () &#123;</div><div class="line">  // ...</div><div class="line">  if (typeof instance.componentWillMount === &apos;function&apos;) &#123;</div><div class="line">    callComponentWillMount(workInProgress, instance);</div><div class="line">    // If we had additional state updates during this life-cycle, let&apos;s process them now.</div><div class="line">    const updateQueue = workInProgress.updateQueue;</div><div class="line">    if (updateQueue !== null) &#123;</div><div class="line">      instance.state = processUpdateQueue(current, workInProgress, updateQueue, instance, props, renderExpirationTime);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  // ...</div><div class="line">&#125;</div><div class="line">function callComponentWillMount(workInProgress, instance) &#123;</div><div class="line">    startPhaseTimer(workInProgress, &apos;componentWillMount&apos;);</div><div class="line">    const oldState = instance.state;</div><div class="line">    instance.componentWillMount();</div><div class="line">    stopPhaseTimer();</div><div class="line">    if (oldState !== instance.state) &#123;</div><div class="line">      // ä¼šå°†æ›´æ–°åŠ å…¥æ›´æ–°é˜Ÿåˆ—</div><div class="line">      updater.enqueueReplaceState(instance, instance.state, null);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="componentDidMount"><a href="#componentDidMount" class="headerlink" title="componentDidMount()"></a>componentDidMount()</h3><p>ç»„ä»¶è£…è½½å®Œæˆåè°ƒç”¨<code>componentDidMount</code>ï¼Œå¯ä»¥åœ¨è¿™ä¸ªæ–¹æ³•ä¸­å»ºç«‹ç½‘ç»œè¿æ¥è·å–æ•°æ®ï¼Œæˆ–è€…å£°æ˜ç›‘å¬å™¨</p>
<p>åœ¨<code>mountClassInstance</code>æ–¹æ³•ä¸­ï¼Œä¹Ÿæœ‰<code>componentDidMount</code>çš„å¯¹åº”é€»è¾‘ã€‚åœ¨è¿™é‡Œåªæ˜¯å°†<code>effectTag</code>çš„å€¼è®¾ç½®ä¸º<code>Update</code>ã€‚ ï¼ˆ<a href="https://github.com/facebook/react/blob/v16.2.0/packages/react-reconciler/src/ReactFiberClassComponent.js" target="_blank" rel="external">ReactFiberClassComponent.js</a>ï¼‰<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">function mountClassInstance () &#123;</div><div class="line">  // ...</div><div class="line">  if (typeof instance.componentDidMount === &apos;function&apos;) &#123;</div><div class="line">    workInProgress.effectTag |= Update;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>åœ¨Fiberæ‰§è¡ŒCommitæ—¶ï¼Œä¼šæ‰§è¡Œ<code>commitLifeCycles</code>ï¼Œå¦‚æœè¯¥ç»„ä»¶çš„<code>effetctTag</code>ä¸º<code>Update</code>ï¼Œå°±ä¼šæ‰§è¡Œç”Ÿå‘½å‘¨æœŸå‡½æ•°<code>componentDidMount</code>æˆ–<code>componentDidUpdate</code>ã€‚é€»è¾‘ä¸ºï¼šå¦‚æœå½“å‰ç»„ä»¶ç¬¬ä¸€æ¬¡Mountï¼Œé‚£ä¹ˆæ‰§è¡Œ<code>componentDidMount</code>ï¼Œå¦‚æœå·²ç»è£…è½½è¿‡ï¼Œåˆ™æ‰§è¡Œ<code>componentDidUpdate</code>ã€‚(<a href="https://github.com/facebook/react/blob/v16.2.0/packages/react-reconciler/src/ReactFiberCommitWork.js" target="_blank" rel="external">ReactFiberCommitWork</a>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">function commitLifeCycles(current: Fiber | null, finishedWork: Fiber): void &#123;</div><div class="line">  switch (finishedWork.tag) &#123;</div><div class="line">    case ClassComponent: &#123;</div><div class="line">      const instance = finishedWork.stateNode;</div><div class="line">      // è¿™é‡Œåš &amp; è¿ç®—ï¼Œæ˜¯ä¸€ä¸ªä½è¿ç®—ï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦æ˜¯æ›´æ–°æ“ä½œ</div><div class="line">      if (finishedWork.effectTag &amp; Update) &#123;  </div><div class="line">        if (current === null) &#123; // ç»„ä»¶ç¬¬ä¸€æ¬¡è£…è½½</div><div class="line">          startPhaseTimer(finishedWork, &apos;componentDidMount&apos;);</div><div class="line">          instance.props = finishedWork.memoizedProps;</div><div class="line">          instance.state = finishedWork.memoizedState;</div><div class="line">          instance.componentDidMount();</div><div class="line">          stopPhaseTimer();</div><div class="line">        &#125; else &#123;</div><div class="line">          // ...</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">      const updateQueue = finishedWork.updateQueue;</div><div class="line">      if (updateQueue !== null) &#123;</div><div class="line">        commitCallbacks(updateQueue, instance);</div><div class="line">      &#125;</div><div class="line">      return;</div><div class="line">    &#125;</div><div class="line">        // ...</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Updatingé˜¶æ®µ"><a href="#Updatingé˜¶æ®µ" class="headerlink" title="Updatingé˜¶æ®µ"></a>Updatingé˜¶æ®µ</h2><p>è¿™ä¸ªé˜¶æ®µä¼šä¾æ¬¡è°ƒç”¨<code>componentWillReceiveProps</code>ã€<code>shouldComponentUpdate</code>ã€<code>componentWillUpdate</code>ã€<code>render</code>ã€<code>componentDidUpdate</code>ã€‚<br>åªæœ‰å½“propsæœ‰å˜åŒ–æ—¶ï¼Œæ‰ä¼šè°ƒç”¨<code>componentWillReceiveProps</code>ã€‚<br>å¦‚æœ<code>shouldComponentUpdate</code>è¿”å›falseï¼Œ<code>componentWillUpdate</code>ã€<code>render</code>ã€<code>componentDidUpdate</code>ä¸ä¼šå†æ‰§è¡Œã€‚</p>
<p>åœ¨Mounté˜¶æ®µçš„æºç åˆ†ææœ‰æåˆ°ï¼šReactä¼šå…ˆåˆ¤æ–­ç»„ä»¶æœ‰æ²¡æœ‰è£…è½½ï¼Œå¦‚æœæ²¡æœ‰å°±æ‰§è¡Œè£…è½½çš„æµç¨‹ï¼Œå¦‚æœæœ‰è£…è½½å°±æ‰§è¡Œæ›´æ–°çš„æµç¨‹ã€‚æ‰€ä»¥æ‰§è¡Œæ›´æ–°æµç¨‹æ—¶ï¼Œä¼šæ‰§è¡Œ<code>updateClassInstance</code>æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¸­å®šä¹‰äº†å¦‚ä½•æ‰§è¡Œ<code>componentWillReceiveProps</code>ï¼Œ<code>componentWillUpdate</code>ã€‚ï¼ˆ<a href="https://github.com/facebook/react/blob/v16.2.0/packages/react-reconciler/src/ReactFiberClassComponent.js" target="_blank" rel="external">ReactFiberClassComponent.js</a>ï¼‰</p>
<h3 id="componentWillReceiveProps-newProps-newContext"><a href="#componentWillReceiveProps-newProps-newContext" class="headerlink" title="componentWillReceiveProps(newProps, newContext)"></a>componentWillReceiveProps(newProps, newContext)</h3><p><strong>åŒ<code>componentWillMount</code>ä¸€æ ·ï¼Œåœ¨<code>componentWillReceiveProps</code>ï¼Œä¹Ÿç»™äºˆäº†ç”¨æˆ·ä¸€æ¬¡ä¿®æ”¹stateçš„æœºä¼šï¼ŒåŒæ ·åœ¨è¿™ä¸ªæ–¹æ³•é‡Œè°ƒç”¨<code>setState</code>æ˜¯ä¸ä¼šè§¦å‘äºŒæ¬¡æ›´æ–°çš„ã€‚</strong></p>
<p>åœ¨<code>updateClassInstance</code>æ–¹æ³•ä¸­æœ‰è¿™æ ·ä¸€æ®µä»£ç ã€‚å¾ˆç®€å•çš„é€»è¾‘ï¼Œå°±æ˜¯å½“<code>componentWillReceiveProps</code>æ–¹æ³•å­˜åœ¨æ—¶ï¼Œ<strong>å¹¶ä¸”propsæˆ–contextæœ‰å˜åŒ–</strong> æ—¶ï¼Œè¦æ‰§è¡Œ<code>callComponentWillReceiveProps</code>ã€‚<br>åœ¨è¿™é‡Œéœ€è¦ç‰¹åˆ«æ³¨æ„ä¸€ä¸ªäº‹ï¼šå½“çˆ¶ç»„ä»¶æ›´æ–°æ—¶ï¼Œå­ç»„ä»¶çš„<code>oldProps</code>ä¸<code>newProps</code>å§‹ç»ˆæ˜¯ä¸ç›¸ç­‰çš„ï¼Œæ‰€ä»¥çˆ¶ç»„ä»¶æ›´æ–°æ—¶ï¼Œå­ç»„ä»¶çš„<code>componentWillReceiveProps</code>æ€»æ˜¯ä¼šè¢«è°ƒç”¨ã€‚ä½†æ˜¯å½“å­ç»„ä»¶æ›´æ–°stateæ—¶ï¼Œç”±äº<code>oldProps</code>å’Œ<code>newProps</code>æ˜¯ç›¸ç­‰çš„ï¼Œæ‰€ä»¥ä¸ä¼šè°ƒç”¨<code>componentWillReceiveProps</code>ã€‚<br>åœ¨æ‰§è¡Œå®Œ<code>callComponentWillReceiveProps</code>åï¼Œå¦‚æœæ›´æ–°é˜Ÿåˆ—<code>updateQueue!==null</code>ï¼Œé‚£ä¹ˆéœ€è¦æ›´æ–°stateçš„å€¼ï¼Œè¿™é‡Œæ˜¯ç›´æ¥è°ƒç”¨<code>processUpdateQueue</code>æ›´æ–°stateï¼Œæ‰€ä»¥ä¸ä¼šè§¦å‘äºŒæ¬¡æ›´æ–°ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">if (</div><div class="line">  typeof instance.componentWillReceiveProps === &apos;function&apos; &amp;&amp;</div><div class="line">  (oldProps !== newProps || oldContext !== newContext)</div><div class="line">) &#123;</div><div class="line">  callComponentWillReceiveProps(</div><div class="line">    workInProgress,</div><div class="line">    instance,</div><div class="line">    newProps,</div><div class="line">    newContext,</div><div class="line">  );</div><div class="line">&#125;</div><div class="line"></div><div class="line">if (workInProgress.updateQueue !== null) &#123;</div><div class="line">  newState = processUpdateQueue(current,</div><div class="line">    workInProgress,</div><div class="line">    workInProgress.updateQueue,</div><div class="line">    instance,</div><div class="line">    newProps,</div><div class="line">    renderExpirationTime,</div><div class="line">  );</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><code>callComponentWillReceiveProps</code>ä¼šè°ƒç”¨ç»„ä»¶çš„<code>componentWillReceiveProps</code>æ–¹æ³•ï¼Œå¹¶ä¸”å¦‚æœstateæœ‰æ”¹å˜ï¼Œå°†æ›´æ–°åŠ å…¥åˆ°æ›´æ–°é˜Ÿåˆ—ä¸­ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">function callComponentWillReceiveProps(</div><div class="line">    workInProgress,</div><div class="line">    instance,</div><div class="line">    newProps,</div><div class="line">    newContext,</div><div class="line">) &#123;</div><div class="line">  startPhaseTimer(workInProgress, &apos;componentWillReceiveProps&apos;);</div><div class="line">  const oldState = instance.state;</div><div class="line">  instance.componentWillReceiveProps(newProps, newContext);</div><div class="line">  stopPhaseTimer();</div><div class="line">  // ....</div><div class="line"></div><div class="line">  if (instance.state !== oldState) &#123;</div><div class="line">    updater.enqueueReplaceState(instance, instance.state, null);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="shouldComponentUpdate-newProps-newState-newContext"><a href="#shouldComponentUpdate-newProps-newState-newContext" class="headerlink" title="shouldComponentUpdate(newProps, newState, newContext)"></a>shouldComponentUpdate(newProps, newState, newContext)</h3><p><code>shouldComponentUpdate</code>ï¼Œåœ¨ç»„ä»¶æ¯æ¬¡æ›´æ–°çš„æ—¶å€™éƒ½ä¼šè°ƒç”¨ï¼Œé™¤éç»„ä»¶è°ƒç”¨äº†<code>forceUpdate</code>ã€‚<br>åŒæ ·åœ¨<code>updateClassInstance</code>æ–¹æ³•ä¸­æœ‰è¿™æ ·ä¸€ä¸ªé€»è¾‘ï¼Œå…ˆè®¡ç®—<code>shouldUpdate</code>ï¼Œç„¶åæ ¹æ®shouldUpdateå»åˆ¤æ–­æ˜¯å¦æ‰§è¡Œæ›´æ–°<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">const shouldUpdate = checkShouldComponentUpdate(</div><div class="line">  workInProgress,</div><div class="line">  oldProps,</div><div class="line">  newProps,</div><div class="line">  oldState,</div><div class="line">  newState,</div><div class="line">  newContext,</div><div class="line">);</div><div class="line">if (shouldUpdate) &#123;</div><div class="line">  // æ‰§è¡Œæ›´æ–°</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>åœ¨<code>checkShouldComponentUpdate</code>å‡½æ•°ä¸­ï¼Œä»<code>workInProgress.updateQueue.hasForceUpdate</code>è¿™å¥è¯æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå¦‚æœåœ¨æ›´æ–°è¿‡ç¨‹ä¸­æœ‰è°ƒç”¨<code>forceUpdate</code>æ–¹æ³•ï¼Œä¼šè·³è¿‡<code>shouldComponentUpdate</code>æ–¹æ³•ï¼Œæ‰§è¡Œæ›´æ–°æµç¨‹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">function checkShouldComponentUpdate(workInProgress, oldProps, newProps, oldState, newState, newContext) &#123;</div><div class="line">  if (oldProps === null || (workInProgress.updateQueue !== null &amp;&amp; workInProgress.updateQueue.hasForceUpdate)) &#123;</div><div class="line">    // If the workInProgress already has an Update effect, return true</div><div class="line">    return true;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  const instance = workInProgress.stateNode;</div><div class="line">  const type = workInProgress.type;</div><div class="line">  // å¦‚æœæœ‰`shouldComponentUpdate`ï¼Œå°±æ‰§è¡Œå®ƒï¼Œå¹¶å°†å…¶è¿”å›å€¼èµ‹å€¼ç»™`shouldUpdate`</div><div class="line">  if (typeof instance.shouldComponentUpdate === &apos;function&apos;) &#123;</div><div class="line">    startPhaseTimer(workInProgress, &apos;shouldComponentUpdate&apos;);</div><div class="line">    const shouldUpdate = instance.shouldComponentUpdate(newProps, newState, newContext,);</div><div class="line">    stopPhaseTimer();</div><div class="line">  &#125;</div><div class="line">  return shouldUpdate;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="componentWillUpdate-newProps-newState-newContext"><a href="#componentWillUpdate-newProps-newState-newContext" class="headerlink" title="componentWillUpdate(newProps, newState, newContext)"></a>componentWillUpdate(newProps, newState, newContext)</h3><p>åœ¨<code>updateClassInstance</code>æ–¹æ³•ä¸­ï¼Œå½“<code>shouldUpdate</code>ä¸ºtrueæ—¶å°±ä¼šæ‰§è¡Œæ›´æ–°ç¨‹åºï¼Œå¦‚æœ<code>componentWillUpdate</code>å­˜åœ¨ï¼Œå°±ä¼šæ‰§è¡Œå®ƒ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">if (shouldUpdate) &#123;</div><div class="line">  if (typeof instance.componentWillUpdate === &apos;function&apos;) &#123;</div><div class="line">    startPhaseTimer(workInProgress, &apos;componentWillUpdate&apos;);</div><div class="line">    instance.componentWillUpdate(newProps, newState, newContext);</div><div class="line">    stopPhaseTimer();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="componentDidUpdate-prevProps-prevState"><a href="#componentDidUpdate-prevProps-prevState" class="headerlink" title="componentDidUpdate(prevProps, prevState)"></a>componentDidUpdate(prevProps, prevState)</h3><p>åœ¨<code>updateClassInstance</code>æ–¹æ³•ä¸­ï¼Œå½“<code>shouldUpdate</code>ä¸ºtrueæ—¶å°±ä¼šæ‰§è¡Œæ›´æ–°ç¨‹åºï¼Œå¦‚æœ<code>componentDidUpdate</code>å­˜åœ¨ï¼Œè®¾ç½®<code>effectTag</code>ä¸º<code>Update</code>ï¼Œå¹¶ç­‰å¾…æ›´æ–°å®Œæˆã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">if (shouldUpdate) &#123;</div><div class="line">  if (typeof instance.componentDidUpdate === &apos;function&apos;) &#123;</div><div class="line">    workInProgress.effectTag |= Update;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>åœ¨<code>componentDidMount</code>çš„åˆ†æä¸­æåˆ°ï¼Œï¼ˆå½“ç»„ä»¶æ›´æ–°å®Œæˆï¼Œä¼šæ‰§è¡Œ<code>commitLifeCycles</code>æ–¹æ³•ï¼Œé€»è¾‘ä¸ºï¼šå¦‚æœå½“å‰ç»„ä»¶ç¬¬ä¸€æ¬¡Mountï¼Œé‚£ä¹ˆæ‰§è¡Œï¼Œå¦‚æœå·²ç»è£…è½½è¿‡ï¼Œåˆ™æ‰§è¡Œ<code>componentDidUpdate</code>ï¼‰ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">if (current === null) &#123;</div><div class="line">  // æ‰§è¡ŒcomponentDidMount</div><div class="line">&#125; else &#123;</div><div class="line">  // æ‰§è¡ŒcomponentDidUpdate</div><div class="line">  const prevProps = current.memoizedProps;</div><div class="line">  const prevState = current.memoizedState;</div><div class="line">  startPhaseTimer(finishedWork, &apos;componentDidUpdate&apos;);</div><div class="line">  instance.props = finishedWork.memoizedProps;</div><div class="line">  instance.state = finishedWork.memoizedState;</div><div class="line">  instance.componentDidUpdate(prevProps, prevState);</div><div class="line">  stopPhaseTimer();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Error-Handing"><a href="#Error-Handing" class="headerlink" title="Error Handing"></a>Error Handing</h2><h3 id="componentDidCatch-error-info"><a href="#componentDidCatch-error-info" class="headerlink" title="componentDidCatch(error, info)"></a>componentDidCatch(error, info)</h3><p>å½“å­ç»„ä»¶çš„å‘¨æœŸå‡½æ•°ä¸­æœ‰é”™è¯¯å‘ç”Ÿæ—¶ï¼Œé”™è¯¯ä¼šè¢«çˆ¶ç»„ä»¶çš„componentDidCatchæ•è·<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">function commitErrorHandling(effectfulFiber: Fiber) &#123;</div><div class="line">  // å¦‚æœeffectfulFiber.tagä¸ºClassComponentï¼Œå°±è°ƒç”¨componentDidCatchæ¥å¤„ç†é”™è¯¯</div><div class="line">  switch (effectfulFiber.tag) &#123;</div><div class="line">    case ClassComponent:</div><div class="line">      const instance = effectfulFiber.stateNode;</div><div class="line">      const info: HandleErrorInfo = &#123;</div><div class="line">        componentStack: capturedError.componentStack,</div><div class="line">      &#125;;</div><div class="line">      instance.componentDidCatch(capturedError.error, info);</div><div class="line">      return;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><h3 id="Reactå®è§‚ä¸Šçš„æ¸²æŸ“"><a href="#Reactå®è§‚ä¸Šçš„æ¸²æŸ“" class="headerlink" title="Reactå®è§‚ä¸Šçš„æ¸²æŸ“"></a>Reactå®è§‚ä¸Šçš„æ¸²æŸ“</h3><p>Reactæ•°æ®ä¼ é€’æ˜¯ç½®é¡¶å‘ä¸‹çš„ï¼ŒReactæ•´ä½“ä¸Šçš„æ¸²æŸ“ä¹Ÿæ˜¯ç½®é¡¶å‘ä¸‹çš„ã€‚å¯ä»¥å°†Reactç»„ä»¶çš„æ¸²æŸ“æ“ä½œæƒ³è±¡æˆä¸€ä¸ªå…ˆå…¥å…ˆå‡ºçš„é˜Ÿåˆ—ï¼Œç»„ä»¶å…¥é˜Ÿåˆ—ä¹‹å‰æ‰§è¡Œrenderä»¥åŠrenderä¹‹å‰çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œå‡ºé˜Ÿåˆ—ä¹‹å‰æ‰§è¡Œrenderä¹‹åçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">// ç»„ä»¶ç¬¬ä¸€æ¬¡åŠ è½½</div><div class="line">parent constructor â†’ parent will mount â†’ parent render â†’ child constructor â†’ child will mount â†’ child render â†’ child did mount â†’ parent did mount</div><div class="line">// ç»„ä»¶æ›´æ–°</div><div class="line">parent will update â†’ parent render â†’ child will update â†’ child render â†’ child did update â†’ parent did update</div></pre></td></tr></table></figure></p>
<h3 id="ä»æºç çœ‹ç»„ä»¶çš„æ¸²æŸ“"><a href="#ä»æºç çœ‹ç»„ä»¶çš„æ¸²æŸ“" class="headerlink" title="ä»æºç çœ‹ç»„ä»¶çš„æ¸²æŸ“"></a>ä»æºç çœ‹ç»„ä»¶çš„æ¸²æŸ“</h3><p>åœ¨ç»„ä»¶å¼€å§‹æ¸²æŸ“æ—¶ï¼ŒFiberä¼šé¦–å…ˆåˆ›å»ºä¸€é¢—Fiber treeï¼Œå¹¶cloneä¸€ä¸ªçš„å‰¯æœ¬ï¼šworkInProgressã€‚<br>æ›´æ–°æ—¶ï¼Œå¯¹æ¯”currentå’ŒworkInProgressçš„å·®å¼‚ï¼ŒFiberå°†æœ‰å˜åŒ–çš„Componentçš„effectTagä¸ºUpdateã€‚<br>åœ¨å¯¹æ¯”currentå’ŒworkInProgressçš„è¿‡ç¨‹ä¸­ä¼šè°ƒç”¨constructorã€componentWillMountã€componentWillReceivePropsã€shouldComponentUpdateã€componentWillUpdateã€‚å¦‚æœåœ¨componentWillMountå’ŒcomponentWillReceivePropsä¸­è°ƒç”¨äº†setStateï¼Œå¯¹stateçš„æ›´æ”¹ä¼šè¢«åŠ å…¥æ›´æ–°é˜Ÿåˆ—ï¼Œéšåå°†ç«‹å³æ‰§è¡Œæ›´æ–°é˜Ÿåˆ—å¾—åˆ°æ–°çš„stateã€‚<br>å½“å®Œæˆcurrentå’ŒworkInProgressæ¯”è¾ƒåï¼ŒFiberå°±ä¼šæ‰§è¡ŒCommitå®Œæˆæ¸²æŸ“ï¼Œè¿™ä¸ªé˜¶æ®µä¼šè°ƒç”¨componentDidMountã€componentDidUpdateã€componentWillUnmountã€‚å¦‚æœcomponentDidMountã€componentDidUpdateæœ‰è°ƒç”¨setStateï¼Œä¼šè§¦å‘äºŒæ¬¡æ¸²æŸ“ã€‚</p>
<h3 id="æ— çŠ¶æ€ç»„ä»¶çš„æ¸²æŸ“"><a href="#æ— çŠ¶æ€ç»„ä»¶çš„æ¸²æŸ“" class="headerlink" title="æ— çŠ¶æ€ç»„ä»¶çš„æ¸²æŸ“"></a>æ— çŠ¶æ€ç»„ä»¶çš„æ¸²æŸ“</h3><p>é€šè¿‡<code>Function</code>åˆ›å»ºçš„ç»„ä»¶æ˜¯æ— çŠ¶æ€ç»„ä»¶ï¼Œå®ƒæ˜¯æ²¡æœ‰ç”Ÿå‘½å‘¨æœŸï¼Œä¹Ÿä¸éœ€è¦ç®¡ç†stateï¼Œæ¯æ¬¡éƒ½ä¼šè¢«é‡æ–°æ¸²æŸ“ã€‚</p>
<h3 id="æœ‰çŠ¶æ€ç»„ä»¶çš„æ¸²æŸ“"><a href="#æœ‰çŠ¶æ€ç»„ä»¶çš„æ¸²æŸ“" class="headerlink" title="æœ‰çŠ¶æ€ç»„ä»¶çš„æ¸²æŸ“"></a>æœ‰çŠ¶æ€ç»„ä»¶çš„æ¸²æŸ“</h3><p>é€šè¿‡<code>ES6 class</code>åˆ›å»ºçš„ç»„ä»¶æ˜¯æœ‰ç”Ÿå‘½å‘¨æœŸå‡½æ•°çš„ï¼Œå¯ä»¥ç®¡ç†è‡ªå·±çš„stateã€‚<br>è¿™ç±»ç»„ä»¶çš„æ¸²æŸ“åˆ†ä¸ºäº†ä¸‰ä¸ªé˜¶æ®µï¼šMountã€Unmountã€Updateã€‚ç»„ä»¶çš„Mounté˜¶æ®µåªä¼šåœ¨ç»„ä»¶è£…è½½çš„æ—¶å€™æ‰§è¡Œä¸€æ¬¡ï¼ŒUpdateé˜¶æ®µä¼šåœ¨ç»„ä»¶propsæˆ–stateæœ‰å˜åŒ–æ—¶æ‰§è¡Œã€‚<br>Mounté˜¶æ®µä¼šæ‰§è¡Œçš„å‘¨æœŸå‡½æ•°æœ‰ï¼šconstructorã€componentWillMountã€renderã€componentDidMountã€‚<br>Updateé˜¶æ®µä¼šæ‰§è¡Œçš„å‘¨æœŸå‡½æ•°æœ‰ï¼šcomponentWillReceivePropsã€shouldComponentUpdateã€componentWillUpdateã€renderã€componentDidUpdate<br>åœ¨React v16.0ä»¥åæ–°å¢ä¸€ä¸ªé˜¶æ®µï¼šError Handingï¼Œè¿™ä¸ªé˜¶æ®µä¼šæ‰§è¡Œå‘¨æœŸå‡½æ•°ï¼šcomponentDidCatch</p>
<h4 id="propså˜åŒ–å¼•èµ·çš„update"><a href="#propså˜åŒ–å¼•èµ·çš„update" class="headerlink" title="propså˜åŒ–å¼•èµ·çš„update"></a>propså˜åŒ–å¼•èµ·çš„update</h4><p>ç»„ä»¶çš„propså˜åŒ–å¯¼è‡´ç»„ä»¶æ›´æ–°æ—¶ï¼Œä¼šè°ƒç”¨componentWillReceivePropsã€‚<br>æ³¨æ„ï¼šçˆ¶ç»„ä»¶æ¯æ¬¡æ›´æ–°åï¼Œä¼ é€’ç»™å­ç»„ä»¶çš„propséƒ½ä¼šå˜åŒ–ã€‚è¿™å°±æ„å‘³ç€çˆ¶ç»„ä»¶æ›´æ–°åï¼Œå­ç»„ä»¶é»˜è®¤éƒ½ä¼šæ›´æ–°ã€‚</p>
<h4 id="stateå˜åŒ–å¼•èµ·çš„update"><a href="#stateå˜åŒ–å¼•èµ·çš„update" class="headerlink" title="stateå˜åŒ–å¼•èµ·çš„update"></a>stateå˜åŒ–å¼•èµ·çš„update</h4><p>ç»„ä»¶è‡ªèº«çš„stateå˜åŒ–å¯¼è‡´ç»„ä»¶æ›´æ–°æ—¶ï¼Œä¸ä¼šè°ƒç”¨componentWillReceivePropsã€‚<br>æ³¨æ„ï¼šå­ç»„ä»¶æ›´æ–°ä¸ä¼šå¼•èµ·çˆ¶ç»„ä»¶æ›´æ–°ï¼Œå› ä¸ºåœ¨Reactä¸­æ›´æ–°æ—¶å±€éƒ¨çš„ã€‚</p>
<h3 id="æ”¹å˜state"><a href="#æ”¹å˜state" class="headerlink" title="æ”¹å˜state"></a>æ”¹å˜state</h3><p>é€šè¿‡setStateæ¥æ›´æ”¹ç»„ä»¶çš„stateï¼Œå¹¶ä¸”setStateæ˜¯ä¸€ä¸ªå¼‚æ­¥çš„åŠ¨ä½œã€‚è°ƒç”¨<code>setState</code>å¯¹stateçš„æ›´æ”¹éƒ½ä¼šè¢«æ”¾åˆ°æ›´æ–°é˜Ÿåˆ—ä¸­ã€‚æ‰€ä»¥åœ¨ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­è°ƒç”¨setStateåï¼Œç«‹å³è®¿é—®stateè¿˜ä¼šæ˜¯æ—§çš„å€¼ã€‚</p>
<h3 id="æ€§èƒ½ä¼˜åŒ–"><a href="#æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–"></a>æ€§èƒ½ä¼˜åŒ–</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œçˆ¶ç»„ä»¶æ›´æ–°ï¼Œå…¶ä¸‹çš„æ‰€æœ‰å­ç»„ä»¶éƒ½ä¼šæ›´æ–°ï¼Œå› ä¸ºè™½ç„¶propsçš„å€¼æ²¡æœ‰å˜åŒ–ï¼Œä½†æ˜¯å®ƒçš„å¼•ç”¨å˜äº†ã€‚<br>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>shouldComponentUpdate</code>é»˜è®¤è¿”å›<code>true</code>ï¼Œç»„ä»¶stateå³ä½¿æ²¡æœ‰å˜åŒ–ï¼Œåªè¦è°ƒç”¨äº†<code>setState</code>ï¼Œç»„ä»¶éƒ½ä¼šæ›´æ–°ã€‚<br>å¯ä»¥åœ¨<code>shouldComponentUpdate</code>é‡Œï¼Œé€šè¿‡åˆ¤æ–­oldPropså’ŒnewPropsçš„å€¼æ˜¯å¦ç›¸ç­‰ï¼ŒoldStateå’ŒnewStateçš„å€¼æ˜¯å¦ç›¸ç­‰æ¥æ§åˆ¶ç»„ä»¶çš„æ›´æ–°ï¼Œè¾¾åˆ°æ€§èƒ½ä¼˜åŒ–çš„ç›®çš„ã€‚</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/react/" rel="tag"># react</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/01/03/ES6å­¦ä¹ ï¼šIteratorå’ŒGenerator/" rel="next" title="ES6å­¦ä¹ ï¼šIteratorå’ŒGenerator">
                <i class="fa fa-chevron-left"></i> ES6å­¦ä¹ ï¼šIteratorå’ŒGenerator
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/01/17/Reactå­¦ä¹ ï¼šReact-Element/" rel="prev" title="Reactå­¦ä¹ ï¼šReact Element">
                Reactå­¦ä¹ ï¼šReact Element <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC8zMjg3NC85NDM1"></div>
    </div>
  


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/uploads/my.jpg"
                alt="TJ" />
            
              <p class="site-author-name" itemprop="name">TJ</p>
              <p class="site-description motion-element" itemprop="description">xiaoxiaojing's blog</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">47</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">17</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/xiaoxiaojing" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i></a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:happyxxj123@gmail.com" target="_blank" title="E-Mail">
                    
                      <i class="fa fa-fw fa-envelope"></i></a>
                </span>
              
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#å…³äºåˆ›å»ºç»„ä»¶çš„ä¸€æ®µå†å²"><span class="nav-number">1.</span> <span class="nav-text">å…³äºåˆ›å»ºç»„ä»¶çš„ä¸€æ®µå†å²</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#React-createClass"><span class="nav-number">1.1.</span> <span class="nav-text">React.createClass</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ"><span class="nav-number">2.</span> <span class="nav-text">ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Unmountingé˜¶æ®µ"><span class="nav-number">3.</span> <span class="nav-text">Unmountingé˜¶æ®µ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æºç åˆ†æ"><span class="nav-number">3.1.</span> <span class="nav-text">æºç åˆ†æ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å®ä¾‹è¯´æ˜"><span class="nav-number">3.2.</span> <span class="nav-text">å®ä¾‹è¯´æ˜</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Mountingé˜¶æ®µ"><span class="nav-number">4.</span> <span class="nav-text">Mountingé˜¶æ®µ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#constructor-props-context"><span class="nav-number">4.1.</span> <span class="nav-text">constructor(props, context)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#componentWillMount"><span class="nav-number">4.2.</span> <span class="nav-text">componentWillMount()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#componentDidMount"><span class="nav-number">4.3.</span> <span class="nav-text">componentDidMount()</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Updatingé˜¶æ®µ"><span class="nav-number">5.</span> <span class="nav-text">Updatingé˜¶æ®µ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#componentWillReceiveProps-newProps-newContext"><span class="nav-number">5.1.</span> <span class="nav-text">componentWillReceiveProps(newProps, newContext)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#shouldComponentUpdate-newProps-newState-newContext"><span class="nav-number">5.2.</span> <span class="nav-text">shouldComponentUpdate(newProps, newState, newContext)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#componentWillUpdate-newProps-newState-newContext"><span class="nav-number">5.3.</span> <span class="nav-text">componentWillUpdate(newProps, newState, newContext)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#componentDidUpdate-prevProps-prevState"><span class="nav-number">5.4.</span> <span class="nav-text">componentDidUpdate(prevProps, prevState)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Error-Handing"><span class="nav-number">6.</span> <span class="nav-text">Error Handing</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#componentDidCatch-error-info"><span class="nav-number">6.1.</span> <span class="nav-text">componentDidCatch(error, info)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ€»ç»“"><span class="nav-number">7.</span> <span class="nav-text">æ€»ç»“</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Reactå®è§‚ä¸Šçš„æ¸²æŸ“"><span class="nav-number">7.1.</span> <span class="nav-text">Reactå®è§‚ä¸Šçš„æ¸²æŸ“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä»æºç çœ‹ç»„ä»¶çš„æ¸²æŸ“"><span class="nav-number">7.2.</span> <span class="nav-text">ä»æºç çœ‹ç»„ä»¶çš„æ¸²æŸ“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ— çŠ¶æ€ç»„ä»¶çš„æ¸²æŸ“"><span class="nav-number">7.3.</span> <span class="nav-text">æ— çŠ¶æ€ç»„ä»¶çš„æ¸²æŸ“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æœ‰çŠ¶æ€ç»„ä»¶çš„æ¸²æŸ“"><span class="nav-number">7.4.</span> <span class="nav-text">æœ‰çŠ¶æ€ç»„ä»¶çš„æ¸²æŸ“</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#propså˜åŒ–å¼•èµ·çš„update"><span class="nav-number">7.4.1.</span> <span class="nav-text">propså˜åŒ–å¼•èµ·çš„update</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#stateå˜åŒ–å¼•èµ·çš„update"><span class="nav-number">7.4.2.</span> <span class="nav-text">stateå˜åŒ–å¼•èµ·çš„update</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ”¹å˜state"><span class="nav-number">7.5.</span> <span class="nav-text">æ”¹å˜state</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ€§èƒ½ä¼˜åŒ–"><span class="nav-number">7.6.</span> <span class="nav-text">æ€§èƒ½ä¼˜åŒ–</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2017 &mdash; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">TJ</span>

  
</div>








  <div class="footer-custom">my love, I will find you!</div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  










  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/canvas-ribbon/canvas-ribbon.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  








  





  

  

  

  

  

  

</body>
</html>
